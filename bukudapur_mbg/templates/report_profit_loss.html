{% extends "base.html" %}
{% block content %}
<div class="card">
  <div class="row" style="justify-content: space-between; align-items:center;">
    <div>
      <h3 class="title">Laporan Laba Rugi</h3>
    </div>
    <a class="btn btn-ghost" href="{{ url_for('main.export_profit_loss_pdf') }}">â¬‡ Export PDF</a>
  </div>

<form method="get" class="row" style="gap:10px; align-items:end; margin:10px 0;">
  <div>
    <label class="subtitle">Dari Tanggal</label>
    <input type="date" name="from" value="{{ dfrom }}" class="input">
  </div>
  <div>
    <label class="subtitle">Sampai Tanggal</label>
    <input type="date" name="to" value="{{ dto }}" class="input">
  </div>
  <button class="btn btn-primary" type="submit">Terapkan</button>

  <a class="btn" href="{{ url_for('main.report_profit_loss') }}">Reset</a>

  <a class="btn btn-ghost"
     href="{{ url_for('main.export_profit_loss_pdf', from=dfrom, to=dto) }}">
    Export PDF
  </a>
</form>
<hr class="sep">

  <hr class="sep">

  <h4>PENDAPATAN USAHA</h4>
  <table>
    {% for a, amt in rev_main_data %}
    <tr>
      <td>{{ a.name }}</td>
      <td style="text-align:right;">Rp {{ "{:,.0f}".format(amt) }}</td>
    </tr>
    {% endfor %}
    <tr>
      <th>Total Pendapatan Usaha</th>
      <th style="text-align:right;">Rp {{ "{:,.0f}".format(total_rev_main) }}</th>
    </tr>
  </table>

  <div class="spacer"></div>

  <h4>HARGA POKOK PENJUALAN</h4>
  <table>
    {% for a, amt in hpp_data %}
    <tr>
      <td>{{ a.name }}</td>
      <td style="text-align:right;">Rp {{ "{:,.0f}".format(amt) }}</td>
    </tr>
    {% endfor %}
    <tr>
      <th>Total Harga Pokok Penjualan</th>
      <th style="text-align:right;">Rp {{ "{:,.0f}".format(total_hpp) }}</th>
    </tr>
  </table>

  <div class="spacer"></div>

  <div class="card soft">
    <h3 class="title">Laba (Rugi) Kotor: Rp {{ "{:,.0f}".format(gross_profit) }}</h3>
  </div>

  <div class="spacer"></div>

  <h4>BEBAN OPERASIONAL</h4>
  <table>
    {% for a, amt in op_exp_data %}
    <tr>
      <td>{{ a.name }}</td>
      <td style="text-align:right;">Rp {{ "{:,.0f}".format(amt) }}</td>
    </tr>
    {% endfor %}
    <tr>
      <th>Total Beban Operasional</th>
      <th style="text-align:right;">Rp {{ "{:,.0f}".format(total_op_exp) }}</th>
    </tr>
  </table>

  <div class="spacer"></div>

  <div class="card soft">
    <h3 class="title">Laba (Rugi) Operasional: Rp {{ "{:,.0f}".format(operating_profit) }}</h3>
  </div>

  <div class="spacer"></div>

  <h4>PENDAPATAN DI LUAR USAHA</h4>
  <table>
    {% for a, amt in rev_other_data %}
    <tr>
      <td>{{ a.name }}</td>
      <td style="text-align:right;">Rp {{ "{:,.0f}".format(amt) }}</td>
    </tr>
    {% endfor %}
    <tr>
      <th>Total Pendapatan di Luar Usaha</th>
      <th style="text-align:right;">Rp {{ "{:,.0f}".format(total_rev_other) }}</th>
    </tr>
  </table>

  <div class="spacer"></div>

  <h4>BEBAN DI LUAR USAHA</h4>
  <table>
    {% for a, amt in exp_other_data %}
    <tr>
      <td>{{ a.name }}</td>
      <td style="text-align:right;">Rp {{ "{:,.0f}".format(amt) }}</td>
    </tr>
    {% endfor %}
    <tr>
      <th>Total Beban di Luar Usaha</th>
      <th style="text-align:right;">Rp {{ "{:,.0f}".format(total_exp_other) }}</th>
    </tr>
  </table>

  <div class="spacer"></div>

  <div class="card">
    <h2 class="title">Laba (Rugi) Bersih: Rp {{ "{:,.0f}".format(net_profit) }}</h2>
  </div>

</div>
{% endblock %}
